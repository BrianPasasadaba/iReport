{% extends 'admin/admin_base.html' %} {% block content%}
<div id="page-content-wrapper">
  <div class="container-fluid px-4">
    <div class="card">
      <div class="card-title">ADMIN ACCOUNTS</div>
      <div>
        <a href="{{ url_for('create_account') }}">
          <button class="btn btn-primary">Create New Account</button>
        </a>
      </div>
      <div class="row">
        <table id="accountTable" style="width: 100%">
          <thead>
            <tr>
              <th class="th text-center">Admin ID</th>
              <th class="th text-center">Last Name</th>
              <th class="th text-center">First Name</th>
              <th class="th text-center">Middle Name</th>
              <th class="th text-center">Name Suffix</th>
              <th class="th text-center">Employee ID</th>
              <th class="th text-center">Contact Number</th>
              <th class="th text-center">Email</th>
              <th class="th text-center">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for admin in admins %}
            <tr>
              <td class="text-center">{{ admin[0] }}</td>
              <td class="text-center">{{ admin[1] }}</td>
              <td class="text-center">{{ admin[2] }}</td>
              <td class="text-center">{{ admin[3] }}</td>
              <td class="text-center">{{ admin[4] }}</td>
              <td class="text-center">{{ admin[5] }}</td>
              <td class="text-center">{{ admin[6] }}</td>
              <td class="text-center">{{ admin[7] }}</td>
              <td class="text-center">
                <button class="btn btn-danger" style="border-radius: 25px" data-bs-toggle="modal" data-bs-target="#confirmationModal" data-id="{{ admin[0] }}">
                  Delete
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Start of Confirm Modal -->
<div id="confirmationModal" class="modal fade" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog " style="margin: auto;">
    <div class="modal-content modal-content-1 success">
      <!-- Modal Body -->
      <div class="modal-body" style="text-align: center">
        <i class="fa fa-exclamation-circle fa-8x mb-3" style="color: #a91212;"></i>
        <h5>Are you sure you want to delete</h5>
        <h5>this account?</h5>
      </div>
      <!-- Modal Footer -->
      <div class="modal-footer">
        <!-- Close Button -->
        <button type="button" class="btn btn-primary" id="confirmDeleteButton" style="background-color: #a91212;">
          YES
        </button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="modalCloseButton">
          NO
        </button>
      </div>
    </div>
  </div>
</div>

{% endblock %} {% block script %}
<script>
  $(document).ready(function () {
    $("#accountTable").DataTable({
      //"searching": false, // Disable search bar
      //"paging": false, // Disable pagination
      lengthChange: false, // Disable "entries per page" selection
      order: [[0, "desc"]], // Order by Report ID in descending order
      //"info" : false,
    });
  });
</script>

<script>
  let adminIdToDelete = null;

  // Show confirmation modal and set admin ID to delete
  document.querySelectorAll('[data-bs-toggle="modal"][data-bs-target="#confirmationModal"]').forEach(button => {
    button.addEventListener('click', function() {
      adminIdToDelete = this.getAttribute('data-id');
    });
  });

  // Handle confirmation button click
  document.getElementById('confirmDeleteButton').addEventListener('click', function() {
    if (adminIdToDelete) {
      fetch(`/accounts/delete/${adminIdToDelete}`, {
        method: 'DELETE',
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        }
      })
      .then(response => {
        if (response.ok) {
          window.location.reload(); // Reload the page to reflect the changes
        } else {
          console.error('Failed to delete account');
        }
      })
      .catch(error => console.error('Error:', error));
    }
  });
</script>



{% endblock %}
